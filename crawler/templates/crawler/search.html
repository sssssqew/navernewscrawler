{% extends 'crawler/base.html' %}

{% block content %}

{% if is_saved_alarm %}
<div class="row" style="margin-top: 2%">   
    <div class="col-lg-6 col-lg-offset-3">
        <div class="alert alert-success alert-dismissible" role="alert">
          <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <strong>성공!</strong> 검색한 단어가 DB에 저장되었습니다.
        </div>
    </div>
</div>
{% endif %}
{% if not_keys  %}
<div class="row" style="margin-top: 2%">   
    <div class="col-lg-6 col-lg-offset-3">
        <div class="alert alert-warning alert-dismissible" role="alert">
          <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <strong>경고!</strong> [
          {% for not_key in not_keys %}
          {{ not_key }} 
          {% if not forloop.last %},{% endif %}
          {% endfor %}
          ] 는 존재하지 않는 단어입니다. 먼저 검색하세요. 
        </div>
    </div>
</div>
{% endif %}
{% if not isExistData %}
<div class="row" style="margin-top: 2%">   
    <div class="col-lg-6 col-lg-offset-3">
        <div class="alert alert-danger alert-dismissible" role="alert">
          <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <strong>알림!</strong> 조회결과가 없습니다. 
        </div>
    </div>
</div>
{% else %}

<div id="chart"  style="margin-top:7%;"></div>
<script type="text/javascript">
    var columns_json = '{{ columns|safe }}';
    console.log(columns_json);
    var col = JSON.parse(columns_json);
    console.log(col);

    var chart = c3.generate({
        data: {
            x: 'x',
            columns: col
        },
        axis: {
            x: {
                type: 'timeseries',
                tick: {
                    format: '%Y-%m-%d'
                }
            }
        },
        grid: {
            x: {
                show: true
            },
            y: {
                show: true
            }
        }
    });
</script>
{% endif %}
<script type="text/javascript">
// show file information
  $(document).ready( function() {
      $('#file1').on('fileselect', function(event, numFiles, label) {
          console.log(numFiles);
          console.log(label);
      });
      // show file name 
      $(document).on('change', '#file1', function() {
          var input = $(this),
              numFiles = input.get(0).files ? input.get(0).files.length : 1,
              label = input.val().replace(/\\/g, '/').replace(/.*\//, '');
          input.trigger('fileselect', [numFiles, label]);
          console.log('sylee');
          $('#fname-1').val(label);
      });
      $('#file2').on('fileselect', function(event, numFiles, label) {
          console.log(numFiles);
          console.log(label);
      });
      // show file name 
      $(document).on('change', '#file2', function() {
          var input = $(this),
              numFiles = input.get(0).files ? input.get(0).files.length : 1,
              label = input.val().replace(/\\/g, '/').replace(/.*\//, '');
          input.trigger('fileselect', [numFiles, label]);
          console.log('label');
          $('#fname-2').val(label);
      });
      $('#file3').on('fileselect', function(event, numFiles, label) {
          console.log(numFiles);
          console.log(label);
      });
      // show file name 
      $(document).on('change', '#file3', function() {
          var input = $(this),
              numFiles = input.get(0).files ? input.get(0).files.length : 1,
              label = input.val().replace(/\\/g, '/').replace(/.*\//, '');
          input.trigger('fileselect', [numFiles, label]);
          console.log('label');
          $('#fname-3').val(label);
      });
    });

</script>
{% endblock %}